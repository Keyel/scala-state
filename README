Functional state experiments in scala